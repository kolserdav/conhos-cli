# Файл конфигурации

Файл конфигурации проекта это обязательный файл, который служит для настройки сервисов проекта, он должен быть разположен в корне проекта и его содержание должно соответствовать строгим правилам, которые описаны далее.

> Для автоматического создания базового файла конфигурации вы можете обратиться к [Инициализация проекта](./GettingStarted.md#инициализация_проекта)

## Пример файла конфигурации

```yml
project: my-awesome-project
services:
  node0:
    type: node
    size: mili
    active: true
    public: true
    version: 21-alpine3.18
    command: npm i && npm run start
    ports:
      - port: 3000
        type: http
    environment:
      - PORT=3000
exclude:
  - node_modules
  - dist
```

## Поля файла конфигурации верхнего уровня

### Название проекта:

Идентификатор проекта в облаке

```yml
project: my-awesome-project
```

**Вам строго необходимо следить за уникальностью этого поля между разными проектами, иначе один ваш проект перезапишет другой проект в облаке.**

### Учетные данные сервера

Данный параметр используется для подключения к приватному узлу

```yml
# Опционально
server:
  node_name: my-node # название приватного узла
  api_key: 30dd7745d90ba1e5c461ec8bffc3c649 # апи ключ
```

### Сервисы:

Перечень сервисов которые необходимы для работы приложения проекта

```yml
services:
  # Уникальное имя сервиса
  node0:
    # ... Поля конфигурации сервиса
```

Подробнее о сервисах смотрите в [Поля конфигурации сервиса](./ConfigFile.md#поля_конфигурации_сервиса)

### Исключения

Перечень дочерних файлов или папок, которые не должны загружаться в облако

```yml
# Опционально
exclude:
  - node_modules
  - dist
  - some/nested
```

## Поля конфигурации сервиса

Поле верхнего уровня **services** должно иметь корневое поле с произвольным уникальным названием и вложенный перечень обязательных и опциональных полей.

### Тип сервиса

От этого зависит образ операционной системы и перечень установленных зависимостей сервиса

```yml
type: node
```

Поддерживаемые типы сервисов: _'node' | 'rust' | 'redis' | 'postgres' | 'mysql' | 'adminer'_

### Размер сервиса

От этого зависит выделение ресуров облачного сервера для работы конкретного сервиса

```yml
size: mili
```

Поддерживаемые типы размеров: _'pico' | 'nano' | 'micro' | 'mili' | 'santi' | 'deci' | 'deca' | 'hecto' | 'kilo' | 'mega'_

### Активный сервис

Чтобы сервис был добавлен или обновлен необходимо указать **true**. Если указано **false** то сервис будет удален из облака

```yml
active: true
```

### Публичный сервис

Указывает должен ли сервис быть открытым для интернета по доменному имени или он будет доступен только через [Внутренние ссылки](./ConfigFile.md#внутренние_ссылки) для других сервисов проекта

```yml
public: true
```

### Версия сервиса

Версия сервиса взятая с оффициального DockerHub репозитория. Например для Node.js будет валидной один из поддерживаемых в нстоящее время тегов https://hub.docker.com/_/node

```yml
version: 21-alpine3.18
```

### Стартовая команда

Команда выполняемая при старте сервиса. Должна содержать команды установки и сборки перед запуском программы если это необходимо.

```yml
command: npm i && npm run start
```

### Порты

Порты, которые должны быть проброшены для публичных сервисов наружу, для каждого порта будет использоваться отдельный адрес в сети на 80 и 443 порту.

```yml
ports:
  - port: 3000
    type: http
    # Оптионально
    location: /path-url
```

Поддерживаемые типы портов: _'http' | 'ws'_

### Переменные среды

Массив переменных среды, которые будут доступны процессам внутри сервиса

```yml
environment:
  - PORT=3000
```

### Внутренние ссылки

Массив имен сервисов на которые данный сервис будет иметь выход по внутренним ссылкам.

```yml
depends_on:
  - postgres0
```

> Когда в качестве внутренней ссылки указан один из подключаемых сервисов например **postgres** то переменная среды с адресом этой ссылки будет автоматически добавлена сервису в процессе работы команды **deploy**
